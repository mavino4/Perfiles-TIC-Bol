bd_f$P158  <- as.factor(bd_f$P158)
bd_f$P159  <- as.factor(bd_f$P159)
bd_f$P160  <- as.factor(bd_f$P160)
bd_f$CodP160 <- as.factor(bd_f$CodP160)
bd_f$Nse <- as.factor(bd_f$Nse)
bd_f$P14[bd_f$P14==9]  <- NA
bd_f$P30[bd_f$P30==99] <- NA
bd_f$P34[bd_f$P34==99] <- NA
summary(bd_f)
bd_fa2 <- bd_f
missmap(bd_fa2, y.labels = NULL,
y.at=NULL, x.cex = 0.4,
main = "Mapa de valores faltantes")
tempDataImput <- readRDS("/home/marco/Documents/Club Data Science/proyecto AGETIC/BASES/tempDataImput.rds")
tempDataImput$method
plots <- list()
plots[[1]]  <- stripplot(tempDataImput,P14  , pch = 20, cex = 1.2)
plots[[2]]  <- stripplot(tempDataImput,P15A , pch = 20, cex = 1.2)
plots[[3]]  <- stripplot(tempDataImput,P30  , pch = 20, cex = 1.2)
plots[[4]]  <- stripplot(tempDataImput,P31A , pch = 20, cex = 1.2)
plots[[5]]  <- stripplot(tempDataImput,P32  , pch = 20, cex = 1.2)
plots[[6]]  <- stripplot(tempDataImput,P33  , pch = 20, cex = 1.2)
plots[[7]]  <- stripplot(tempDataImput,P34  , pch = 20, cex = 1.2)
plots[[8]]  <- stripplot(tempDataImput,P35  , pch = 20, cex = 1.2)
plots[[9]]  <- stripplot(tempDataImput,P36A , pch = 20, cex = 1.2)
plots[[10]] <- stripplot(tempDataImput,P129A, pch = 20, cex = 1.2)
plots[[11]] <- stripplot(tempDataImput,P130A, pch = 20, cex = 1.2)
plots[[12]] <- stripplot(tempDataImput,P131A, pch = 20, cex = 1.2)
plots[[13]] <- stripplot(tempDataImput,P132A, pch = 20, cex = 1.2)
plots[[14]] <- stripplot(tempDataImput,P133A, pch = 20, cex = 1.2)
plots[[15]] <- stripplot(tempDataImput,P134 , pch = 20, cex = 1.2)
plots[[16]] <- stripplot(tempDataImput,P135 , pch = 20, cex = 1.2)
plots[[17]] <- stripplot(tempDataImput,P136 , pch = 20, cex = 1.2)
plots[[18]] <- stripplot(tempDataImput,P137 , pch = 20, cex = 1.2)
plots[[19]] <- stripplot(tempDataImput,P138 , pch = 20, cex = 1.2)
plots[[20]] <- stripplot(tempDataImput,P139 , pch = 20, cex = 1.2)
plots[[21]] <- stripplot(tempDataImput,P140 , pch = 20, cex = 1.2)
grid.arrange(grobs=plots[1:9]  , ncol=3)
grid.arrange(grobs=plots[10:17], ncol=3)
grid.arrange(grobs=plots[18:21], ncol=3)
bd_fa2c <- complete(tempDataImput,1)
summary(bd_fa2c)
missmap(bd_fa2c, y.labels = NULL,
y.at=NULL, x.cex = 0.4,
main = "Mapa de valores faltantes")
i_data <- readRDS("/home/marco/Documents/Club Data Science/proyecto AGETIC/BASES/bd_imputada.rds")
i_input <- i_data[,-c(1,17,57,58,59,60)]
library(clustMixType)
set.seed(12345)
i_clust.mod <- kproto(i_input,3)
i_clust.table <- table(i_clust.mod$cluster)
round(i_clust.table/nrow(i_input)*100,2)
summary(i_clust.mod)
library(randomForest)
i_new_data <- i_input
i_new_data$cluster <- as.factor(i_clust.mod$cluster)
set.seed(12345)
train = sample(1:nrow(i_new_data), nrow(i_new_data)/2)
set.seed(12345)
i_rf.mod <- randomForest(cluster ~ ., data = i_new_data, subset=train,
importance=TRUE, ntree=2000)
clust.i_rf.hat <- predict(i_rf.mod,newdata = i_new_data[-train,])
i_ct <- table(clust.i_rf.hat,i_new_data[-train,]$cluster)
i_ct
i_ct <- as.matrix(i_ct)
round(sum(diag(i_ct))/nrow(i_new_data[-train,])*100,2)
vi.i_rf.mod <- i_rf.mod$importance[,4]
barplot(vi.i_rf.mod[order(vi.i_rf.mod)],
main = "RF - Variables Importantes",
xlab = "MeanDecreaseAccuracy",horiz = T,
cex.axis = 0.8,
cex.names = 0.4,las=2)
abline(v=0.01,col="red")
vi.i_rf.mod_f <- data.frame(vi.i_rf.mod[vi.i_rf.mod>0.01][order(vi.i_rf.mod[vi.i_rf.mod>0.01],decreasing = T)])
vi.i_rf.mod_f$Variables = c("¿Cuánto pagaron por el televisor?", "¿Tiene computadora de escritorio, computadora portátil o tablet?", "¿Tiene servicio de TV cable?", "Nivel de instrucción Jefe del hogar", "Información que busca en internet", "Nivel de instrucción del entrevistado", "Sexo", "¿Tiene microondas?", "¿Tiene lavadora de ropa?", "¿Qué medio considera el más imparcial?", "¿Qué medio considera el más abierto a su participación?", "Deparetamento", "¿Cuántos días a la semana utiliza la computadora o tablet?", "¿Ingreso promedio mensual del hogar?", "¿Cuánto pagó la última vez que se compro un celular?", "Categoria ocupacional")
colnames(vi.i_rf.mod_f) <- c("MeanDecreaseAccuracy", "Pregunta")
vi.i_rf.mod_f
i_input_f <- i_input[,rownames(vi.i_rf.mod_f)]
set.seed(12345)
i_clust.mod_f <- kproto(i_input_f,3)
#i_clust.mod_f <- factor(i_clust.mod)
#levels(i_clust.mod_f) <- c("A", "B", "C")
i_clust.table_f <- table(i_clust.mod_f$cluster)
round(i_clust.table_f/nrow(i_input_f)*100,2)
i_new_data_f <- i_input_f
i_new_data_f$cluster <- as.factor(i_clust.mod_f$cluster)
set.seed(12345)
i_rf.mod_f <- randomForest(cluster ~ ., data = i_new_data_f, subset=train,
importance=TRUE, ntree=2000)
clust.i_rf_f.hat <- predict(i_rf.mod_f,newdata = i_new_data_f[-train,])
i_ct_f <- table(clust.i_rf_f.hat,i_new_data_f[-train,]$cluster)
i_ct_f <- as.matrix(i_ct_f)
i_ct_f
round(sum(diag(i_ct_f))/nrow(i_new_data_f[-train,])*100,2)
i_new_data_f$cluster = factor(i_new_data_f$cluster,
levels(i_new_data_f$cluster)[c(1,3,2)])
levels(i_new_data_f$cluster) <- c("A","B","C")
round(prop.table(table(i_new_data_f$cluster))*100,2)
library(ggplot2)
#inlcuyendo variables para el análisis
i_new_data_f$P1    <- i_data$P1
i_new_data_f$P150  <- i_data$P150
i_new_data_f$P23   <- i_data$P23
i_new_data_f$P134  <- i_data$P134
i_new_data_f$P131A <- i_data$P131A
i_new_data_f$P23   <- i_data$P23
i_new_data_f$P36A  <- i_data$P36A
i_new_data_f$P136  <- i_data$P136
i_new_data_f$P129A <- i_data$P129A
i_new_data_f$P133A <- i_data$P133A
tapply(i_new_data_f$P14, i_new_data_f$cluster, summary)
ggplot(i_new_data_f, aes(x=cluster, y=P14, fill=cluster)) +
geom_boxplot()
#Aumentamos el margin igual a dos para ver la proporción de personas por cluster que tienen o no acceso computadoras o tables
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P6, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P16, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P16, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P16, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P153, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P153, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P153, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P153, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P153, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster), margin = 2),2)
ggplot(i_new_data_f, aes(x=P159, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster), margin = 2),2)
ggplot(i_new_data_f, aes(x=P159, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin=2),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin =1),2)
ggplot(i_new_data_f, aes(x=P149, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin=2),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin =1),2)
ggplot(i_new_data_f, aes(x=P149, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin=2),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin =1),2)
ggplot(i_new_data_f, aes(x=P149, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin=2),2)
round(prop.table(table(i_new_data_f$P149, i_new_data_f$cluster), margin =1),2)
ggplot(i_new_data_f, aes(x=P149, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
ggplot(i_new_data_f, aes(x=P149, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P148, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P148, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P148, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P148, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P148, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P148, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P156E, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P156E, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P156E, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P156E, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P156E, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P156E, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P156D, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P156D, i_new_data_f$cluster)), margin =2,2)
round(prop.table(table(i_new_data_f$P156D, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P156D, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P156D, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
ggplot(i_new_data_f, aes(x=P156D, fill=cluster)) +
+   geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
ggplot(i_new_data_f, aes(x=P156D, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P138, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P138, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P138, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P140, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P140, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P140, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P140, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P140, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P140, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P140, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P140, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P140, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P158, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P158, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P158, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P158, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P158, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
ggplot(i_new_data_f, aes(x=P158, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P155, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P155, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P155, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P155, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P155, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P155, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P155, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P155, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P155, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
tapply(i_new_data_f$P30, i_new_data_f$cluster, summary)
ggplot(i_new_data_f, aes(x=cluster, y=P30, fill=cluster)) +
geom_boxplot()
round(prop.table(table(i_new_data_f$P152, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P152, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P152, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
install.packages("pyramid")
library(pyramid)
install.packages("pyramid")
library(pyramid)
requires(pyramid)
install.packages("pyramid")
install.packages("pyramid")
pyramid?
¿
?pyramid
??pyramid
library(pyramid)
pyramid(i_new_data_f$P150)
pyramid(i_new_data_f$P150, Cstep =4)
edades <- i_new_data_f$P150
edades
edades <- i_new_data_f$P1
pyramid(i_new_data_f$P, Cstep =4)
pyramid(i_new_data_f$P1)
View(i_new_data_f)
pyramid(i_new_data_f[,c("P1", "cluster")])
pyramid(i_new_data_f[,c("P1", "cluster")], Cstep = 4)
pyramid(i_new_data_f[,c("P1", "cluster")], Cstep = 10)
PyrAgeA <-  i_new_data_f[ which(i_new_data_f$cluster=='A'),c("P1", "P148" ) ]
PyrAgeA
pyramid(PyrAgeA)
hist(PyrAgeA$P1)
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3),
col="red",
aes(fill=..count..))
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3),
aes(fill=..count..))
PyrAgeA <-  i_new_data_f[ which(i_new_data_f$cluster=='A'),c("P1", "P148" ) ]
PyrAgeB <-  i_new_data_f[ which(i_new_data_f$cluster=='B'),c("P1", "P148" ) ]
PyrAgeC <-  i_new_data_f[ which(i_new_data_f$cluster=='C'),c("P1", "P148" ) ]
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))
ggplot(data=PyrAgeC, aes(PyrAgeC$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "ligthgreen")
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "white")
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "red", high = "darkred")
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeC, aes(PyrAgeC$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..)) +
scale_fill_gradient("Count", low = "blue", high = "darkblue")
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "red", high = "darkred")
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeC, aes(Estructura de edades cluster C)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..)) +
scale_fill_gradient("Count", low = "blue", high = "darkblue")
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "red", high = "darkred")
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeC, aes("Estructura de edades cluster C")) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..)) +
scale_fill_gradient("Count", low = "blue", high = "darkblue")
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "red", high = "darkred")
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeC, aes(PyrAgeC$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..)) +
scale_fill_gradient("Count", low = "blue", high = "darkblue")
??pyramid
Pyramid_prueba <- PyrAgeA[which(PyrAgeA$P148=1),P1]
Pyramid_prueba$Muj <- PyrAgeA[which(PyrAgeA$P148=2),P1]
Pyramid_prueba <- PyrAgeA[which(PyrAgeA$P148==1),P1]
Pyramid_prueba$Muj <- PyrAgeA[which(PyrAgeA$P148==2),P1]
Pyramid_prueba <- PyrAgeA[which(PyrAgeA$P148==1),"P1"]
Pyramid_prueba$Muj <- PyrAgeA[which(PyrAgeA$P148==2),"P1"]
Pyramid_prueba
tapply(i_new_data_f$P1, i_new_data_f$cluster, summary)
ggplot(i_new_data_f, aes(x=cluster, y=P1, fill=cluster)) +
geom_boxplot()
PyrAgeA <-  i_new_data_f[ which(i_new_data_f$cluster=='A'),c("P1", "P148" ) ]
PyrAgeB <-  i_new_data_f[ which(i_new_data_f$cluster=='B'),c("P1", "P148" ) ]
PyrAgeC <-  i_new_data_f[ which(i_new_data_f$cluster=='C'),c("P1", "P148" ) ]
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "red", high = "darkred")
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeC, aes(PyrAgeC$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..)) +
scale_fill_gradient("Count", low = "blue", high = "darkblue")
tapply(i_new_data_f$P1, i_new_data_f$cluster, summary)
ggplot(i_new_data_f, aes(x=cluster, y=P1, fill=cluster)) +
geom_boxplot()
PyrAgeA <-  i_new_data_f[ which(i_new_data_f$cluster=='A'),c("P1", "P148" ) ]
PyrAgeB <-  i_new_data_f[ which(i_new_data_f$cluster=='B'),c("P1", "P148" ) ]
PyrAgeC <-  i_new_data_f[ which(i_new_data_f$cluster=='C'),c("P1", "P148" ) ]
ggplot(data=PyrAgeA, aes(PyrAgeA$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "red", high = "darkred")
ggplot(data=PyrAgeB, aes(PyrAgeB$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..))+
scale_fill_gradient("Count", low = "green", high = "darkgreen")
ggplot(data=PyrAgeC, aes(PyrAgeC$P1)) +
geom_histogram(breaks=seq(10, 80, by =3), aes(fill=..count..)) +
scale_fill_gradient("Count", low = "blue", high = "darkblue")
round(prop.table(table(i_new_data_f$P23, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P23, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P23, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P36A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P36A, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P36A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P36A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P36A, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P36A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P36A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P36A, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P36A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P134, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P134, i_new_data_f$cluster),margin = 2),2)
ggplot(i_new_data_f, aes(x=P134, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P136, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P136, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P136, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P129A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P129A, i_new_data_f$cluster),margin=2),2)
ggplot(i_new_data_f, aes(x=P129A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P131A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P131A, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P131A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P133A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P133A, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P133A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster), margin = 2),2)
ggplot(i_new_data_f, aes(x=P159, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster), margin = 2),2)
ggplot(i_new_data_f, aes(x=P159, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster), margin = 2),2)
round(prop.table(table(i_new_data_f$P159, i_new_data_f$cluster), margin = 1),2)
ggplot(i_new_data_f, aes(x=P159, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P153, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P153, i_new_data_f$cluster), margin=2),2)
round(prop.table(table(i_new_data_f$P153, i_new_data_f$cluster), margin=1),2)
ggplot(i_new_data_f, aes(x=P153, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P136, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P136, i_new_data_f$cluster), margin=2),2)
ggplot(i_new_data_f, aes(x=P136, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P134, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P134, i_new_data_f$cluster),margin = 2),2)
ggplot(i_new_data_f, aes(x=P134, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P129A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P129A, i_new_data_f$cluster),margin=2),2)
ggplot(i_new_data_f, aes(x=P129A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
View(bd_fa2)
View(i_new_data_f)
View(i_data)
View(i_data)
summary(i_data$P15A)
library(ggplot2)
#inlcuyendo variables para el análisis
i_new_data_f$P1    <- i_data$P1
i_new_data_f$P150  <- i_data$P150
i_new_data_f$P23   <- i_data$P23
i_new_data_f$P134  <- i_data$P134
i_new_data_f$P131A <- i_data$P131A
i_new_data_f$P23   <- i_data$P23
i_new_data_f$P36A  <- i_data$P36A
i_new_data_f$P136  <- i_data$P136
i_new_data_f$P129A <- i_data$P129A
i_new_data_f$P133A <- i_data$P133A
i_new_data_f$P133A <- i_data$P15A
round(prop.table(table(i_new_data_f$P15A, i_new_data_f$cluster)),2)
library(ggplot2)
#inlcuyendo variables para el análisis
i_new_data_f$P1    <- i_data$P1
i_new_data_f$P150  <- i_data$P150
i_new_data_f$P23   <- i_data$P23
i_new_data_f$P134  <- i_data$P134
i_new_data_f$P131A <- i_data$P131A
i_new_data_f$P23   <- i_data$P23
i_new_data_f$P36A  <- i_data$P36A
i_new_data_f$P136  <- i_data$P136
i_new_data_f$P129A <- i_data$P129A
i_new_data_f$P133A <- i_data$P133A
i_new_data_f$P15A <- i_data$P15A
round(prop.table(table(i_new_data_f$P15A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P15A, i_new_data_f$cluster), margin=2),2)
round(prop.table(table(i_new_data_f$P15A, i_new_data_f$cluster), margin=1),2)
ggplot(i_new_data_f, aes(x=P15A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
round(prop.table(table(i_new_data_f$P15A, i_new_data_f$cluster)),2)
round(prop.table(table(i_new_data_f$P15A, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=P15A, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
View(i_input_f)
View(i_new_data)
View(bd)
View(bd_fa2)
View(bd_fa2)
library(rmarkdown)
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
library(ggplot2)
library(Amelia)
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
render("Análisis de Conglomerados, Encuesta Nacional de Opinión sobre TIC.Rmd", beamer_presentation())
knitr::opts_chunk$set(echo = TRUE)
i_data <- readRDS("/home/marco/Documents/Club Data Science/proyecto AGETIC/BASES/bd_imputada.rds")
