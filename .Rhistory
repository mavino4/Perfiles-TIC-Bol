plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="gray", caxislabels=round(seq(0,max(data),max(data)/4),2) ,
cglwd=0.8,
#custom labels
vlcex=0.8,
pangle = 30,
title = "¿Qué medio de comunicación considera imparcial?"
)
# Custom the radarChart !
radarchart( data  , axistype=1 ,
#custom polygon
pcol=c(rgb(0.2,0.5,0.3,0.8), rgb(0.2,0.5,0.7,0.8), rgb(0.2,0.2,0.3,0.8), "deeppink4" ,rgb(0.2,0.0,0.3,0.8),
rgb(0.2,0.0,0.3,0.8), rgb(0.2,0.5,0.3,0.8) ,rgb(0.1,0.5,0.3,0.8), rgb(0.4,0.5,0.3,0.8)) ,
#, pfcol=rgb(0.2,0.5,0.5,0.5) ,
plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="gray", caxislabels=round(seq(0,max(data),max(data)/4),2) ,
cglwd=0.8,
#custom labels
vlcex=0.8,
pangle = 30,
title = "¿Qué medio de comunicación considera imparcial?"
)
# Library
library(fmsb)
install.packages("fmsb")
# Library
library(fmsb)
data = as.data.frame(t(rbind(round(prop.table(table(i_new_data_f$P138 , i_new_data_f$cluster), margin =2),2))))
data
colnames(data)=c("Tv", "Radio", "P. Imp.", "P. Dig.", "P. Web", "RR SS", "Ninguno", "NS/NR" )
# To use the fmsb package, I have to add 2 lines to the dataframe: the max and min of each topic to show on the plot!
data=rbind(rep(max(data),length(colnames(data))) , rep(min(data),length(colnames(data))) , data)
# The default radar chart proposed by the library:
radarchart(data)
# Custom the radarChart !
radarchart( data  , axistype=1 ,
#custom polygon
pcol=c(rgb(0.2,0.5,0.3,0.8), rgb(0.2,0.5,0.7,0.8), rgb(0.2,0.2,0.3,0.8), "deeppink4" ,rgb(0.2,0.0,0.3,0.8),
rgb(0.2,0.0,0.3,0.8), rgb(0.2,0.5,0.3,0.8) ,rgb(0.1,0.5,0.3,0.8), rgb(0.4,0.5,0.3,0.8)) ,
#, pfcol=rgb(0.2,0.5,0.5,0.5) ,
plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="gray", caxislabels=round(seq(0,max(data),max(data)/4),2) ,
cglwd=0.8,
#custom labels
vlcex=0.8,
pangle = 30,
title = "¿Qué medio de comunicación considera imparcial?"
)
############ gráfica para SI NO
i_new_data_f$P6 <- as.factor(i_new_data_f$P6)
levels(i_new_data_f$P6) <- c("Si","No")
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
library(ggplot2)
############ gráfica para SI NO
i_new_data_f$P6 <- as.factor(i_new_data_f$P6)
levels(i_new_data_f$P6) <- c("Si","No")
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill")
p + geom_bar (aes(fill=P6), position = "fill", title="Tiene computadora, laptop o tablet en su hogar")
p + geom_bar (aes(fill=P6), position = "fill", tittle="Tiene computadora, laptop o tablet en su hogar")
p + geom_bar (aes(fill=P6), position = "fill")
# Custom the radarChart !
radarchart( data  , axistype=1 ,
#custom polygon
pcol=c(rgb(0.2,0.5,0.3,0.8), rgb(0.2,0.5,0.7,0.8), rgb(0.2,0.2,0.3,0.8), "deeppink4" ,rgb(0.2,0.0,0.3,0.8),
rgb(0.2,0.0,0.3,0.8), rgb(0.2,0.5,0.3,0.8) ,rgb(0.1,0.5,0.3,0.8), rgb(0.4,0.5,0.3,0.8)) ,
#, pfcol=rgb(0.2,0.5,0.5,0.5) ,
plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="gray", caxislabels=round(seq(0,max(data),max(data)/4),2) ,
cglwd=0.8,
#custom labels
vlcex=0.8,
pangle = 30,
title = "¿Qué medio de comunicación considera imparcial?"
)
# Custom the radarChart !
radarchart( data  , axistype=1 ,
#custom polygon
pcol=c(rgb(0.2,0.5,0.3,0.8), rgb(0.2,0.5,0.7,0.8), rgb(0.2,0.2,0.3,0.8), "deeppink4" ,rgb(0.2,0.0,0.3,0.8),
rgb(0.2,0.0,0.3,0.8), rgb(0.2,0.5,0.3,0.8) ,rgb(0.1,0.5,0.3,0.8), rgb(0.4,0.5,0.3,0.8)) ,
#, pfcol=rgb(0.2,0.5,0.5,0.5) ,
plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="gray", caxislabels=round(seq(0,max(data),max(data)/4),2) ,
cglwd=0.8,
#custom labels
vlcex=0.8,
pangle = 30
)
############ gráfica para SI NO
i_new_data_f$P6 <- as.factor(i_new_data_f$P6)
levels(i_new_data_f$P6) <- c("Si","No")
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill")
# The default radar chart proposed by the library:
radarchart(data)
a
# Custom the radarChart !
radarchart( data  , axistype=1 ,
#custom polygon
pcol=c(rgb(0.2,0.5,0.3,0.8), rgb(0.2,0.5,0.7,0.8), rgb(0.2,0.2,0.3,0.8), "deeppink4" ,rgb(0.2,0.0,0.3,0.8),
rgb(0.2,0.0,0.3,0.8), rgb(0.2,0.5,0.3,0.8) ,rgb(0.1,0.5,0.3,0.8), rgb(0.4,0.5,0.3,0.8)) ,
#, pfcol=rgb(0.2,0.5,0.5,0.5) ,
plwd=3,
#custom the grid
cglcol="grey", cglty=1, axislabcol="gray", caxislabels=round(seq(0,max(data),max(data)/4),2) ,
cglwd=0.8,
#custom labels
vlcex=0.8,
pangle = 30
)
i_new_data_f$P3<- Internautas$P3
table(i_new_data_f$P3)
i_new_data_f$P3 <- as.factor(i_new_data_f$P3)
levels(i_new_data_f$P3) <- c("[,7]","[8,15]", "[16,30]")
round(prop.table(table(i_new_data_f$P3, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill")
p + geom_bar (aes(fill=P3), position = "fill")
# Edades
tapply(i_new_data_f$P1, i_new_data_f$cluster, summary)
ggplot(i_new_data_f, aes(x=cluster, y=P1, fill=cluster)) +
geom_boxplot() #box plot
i_new_data_f$P2 <- as.factor(i_new_data_f$P2)
levels(i_new_data_f$P2) <- c("Si","No")
table((i_new_data_f$P2))
############ gráfica para SI NO
i_new_data_f$P6 <- as.factor(i_new_data_f$P6)
levels(i_new_data_f$P6) <- c("Si","No")
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill")
p + geom_bar (aes(fill=P6), position = "fill") + geom_text(aes(label=y), vjust=0) +
opts(axis.text.x=theme_blank(),
axis.ticks=theme_blank(),
axis.title.x=theme_blank(),
legend.title=theme_blank(),
axis.title.y=theme_blank()
)
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill")
p
i_new_data_f
i_new_data_f$P6
p + geom_bar (aes(fill=P6), position = "fill") +
geom_text(aes(label = y), position = position_stack(vjust = 0.5))
ggplot(data = df, aes(x, y, group = grp)) +
geom_col(aes(fill = grp)) +
geom_text(aes(label = y), position = position_stack(vjust = 0.5))
df <- data.frame(
x = factor(c(1, 1, 2, 2)),
y = c(1, 3, 2, 1),
grp = c("a", "b", "a", "b")
)
ggplot(data = df, aes(x, y, group = grp)) +
geom_col(aes(fill = grp)) +
geom_text(aes(label = y), position = position_stack(vjust = 0.5))
df
############ gráfica para SI NO
i_new_data_f$P6 <- as.factor(i_new_data_f$P6)
levels(i_new_data_f$P6) <- c("Si","No")
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill") +
geom_text(aes(label = y), position = position_stack(vjust = 0.5))
p + geom_bar (aes(fill=P6), position = "fill")
View(p)
round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a
p + geom_bar (aes(fill=P6), position = "fill") +
geom_text(aes(label = a), position = position_stack(vjust = 0.5))
p + geom_bar (aes(fill=P6), position = "fill")
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?")
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2) + xlab("%")
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") + xlab("%")
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") + ylab("%")
# Ejemplo etiquetas 2
foo <- data.frame(Foo = c(11, 12, 13))
ggplot(foo) + aes(x = 0, y = Foo, fill = Foo, label = Foo) + geom_bar(stat = "identity") +
geom_text()
# Text labels are above their respective bars.
ggplot(foo) + aes(x = 0, y = Foo, fill = Foo, label = Foo) + geom_bar(stat = "identity") +
geom_text(y = cumsum(foo$Foo))
ggplot(foo) + aes(x = 0, y = Foo, fill = Foo, label = Foo) +
geom_bar(stat = "identity") +
geom_text(position = "stack")
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p + geom_bar (aes(fill=P6), position = "fill", label= cluster) + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p + geom_bar (aes(fill=P6), position = "fill", label= leveles(i_new_data_f$P6)) + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p + geom_bar (aes(fill=P6), position = "fill", label= levels(i_new_data_f$P6)) + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p + geom_bar (aes(fill=P6 , label= levels(i_new_data_f$P6)), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%") + geom_text(position = "stack")
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%")
a
typeof(a)
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(aes(label = a))
a
as.vector(a)
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.vector(a)
a
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(aes(label = a))
# Ejemplo etiquetas
Year      <- c(rep(c("2006-07", "2007-08", "2008-09", "2009-10"), each = 4))
Category  <- c(rep(c("A", "B", "C", "D"), times = 4))
Frequency <- c(168, 259, 226, 340, 216, 431, 319, 368, 423, 645, 234, 685, 166, 467, 274, 251)
Data      <- data.frame(Year, Category, Frequency)
library(ggplot2)
p <- qplot(Year, Frequency, data = Data, geom = "bar", fill = Category,     theme_set(theme_bw()))
p + geom_text(aes(label = Frequency), size = 3, hjust = 0.5, vjust = 3, position =     "stack")
# Ejemplo etiquetas
Year      <- c(rep(c("2006-07", "2007-08", "2008-09", "2009-10"), each = 4))
Category  <- c(rep(c("A", "B", "C", "D"), times = 4))
Frequency <- c(168, 259, 226, 340, 216, 431, 319, 368, 423, 645, 234, 685, 166, 467, 274, 251)
Data      <- data.frame(Year, Category, Frequency)
p <- qplot(Year, Frequency, data = Data, geom = "bar", fill = Category,     theme_set(theme_bw()))
p <- qplot(Year, Frequency, data = Data, geom = "bar", fill = Category)
p + geom_text(aes(label = Frequency), size = 3, hjust = 0.5, vjust = 3, position =     "stack")
p + geom_text(aes(label = Frequency), size = 3, hjust = 0.5, vjust = 3, position = "stack")
p <- qplot(Year, Frequency, data = Data, geom = "bar", fill = Category)
p
p <- qplot(Year, Frequency, data = Data, geom = "bar", fill = Category)
p
ggplot(Data, aes(x = Year, y = Frequency, fill = Category, label = Frequency)) +
geom_bar(stat = "identity") +
geom_text(size = 3, position = position_stack(vjust = 0.5))
# Prueba relleno
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a)
a
# Prueba relleno
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a)
a
ggplot(a, aes(x = Var2, y = Freq , fill = Var1, label= Freq )) +
geom_bar (stat = "identity") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=3, position = position_stack(vjust = 0.5))
ggplot(a, aes(x = Var2, y = Freq , fill = Var1, label= Freq )) +
geom_bar (stat = "identity") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=3, position = position_stack(vjust = 0.8))
ggplot(a, aes(x = Var2, y = Freq , fill = Var1, label= Freq )) +
geom_bar (stat = "identity") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=3, position = position_stack(vjust = 0.5))
ggplot(a, aes(x = Var2, y = Freq , fill = Var1, label= Freq )) +
geom_bar (stat = "identity") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=8, position = position_stack(vjust = 0.5))
ggplot(a, aes(x = Var2, y = Freq , fill = Var1, label= Freq )) +
geom_bar (stat = "identity") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
# Gráfica para SI NO con etiquetas
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a, `colnames<-`("Answer", "Cluster", "Freq"))
a <- as.data.frame(a, `colnames<-`c("Answer", "Cluster", "Freq"))
a <- as.data.frame(a, colnames = c("Answer", "Cluster", "Freq"))
a
# Gráfica para SI NO con etiquetas
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a, colnames = c("Answer", "Cluster", "Freq"))
a
a <- as.data.frame(a)
colnames(a) = c("Answer", "Cluster", "Freq")
a
ggplot(a, aes(x = Cluster, y = Freq , fill = Answer, label= Freq )) +
geom_bar (stat = "identity") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
ggplot(a, aes(x = Cluster, y = Freq , fill = Answer, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
p <- ggplot(i_new_data_f, aes(cluster))
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(aes(label = a))
p + geom_bar (aes(fill=P6), position = "fill") + ggtitle("¿Tienen Computadoras?") +
ylab("%")
# Gráfica para SI NO con etiquetas
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a)
colnames(a) = c("P6", "Cluster", "Freq")
a
ggplot(a, aes(x = Cluster, y = Freq , fill = P6, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
# Edades
tapply(i_new_data_f$P1, i_new_data_f$cluster, summary)
ggplot(i_new_data_f, aes(x=cluster, y=P1, fill=cluster)) +
geom_boxplot() #box plot
ggplot(i_new_data_f, aes(x=cluster, y=P1, fill=cluster)) +
geom_boxplot() + ylab("edad") #box plot
ggplot(i_new_data_f, aes(x=cluster, y=P1, fill=cluster)) +
geom_boxplot() + ylab("edad (años)") #box plot
library(XML)
install.packages("XML")
install.packages("XML2")
install.packages("xml2")
library(reshape2)
library(ggplot2)
library(plyr)
library(XML)
get_data <- function(country, year) {
c1 <- "http://www.census.gov/population/international/data/idb/region.php?N=%20Results%20&T=10&A=separate&RT=0&Y="
c2 <- "&R=-1&C="
url <- paste0(c1, year, c2, country)
df <- data.frame(readHTMLTable(url))
keep <- c(2, 4, 5)
df <- df[,keep]
names(df) <- c("Age", "Male", "Female")
cols <- 2:3
df[,cols] <- apply(df[,cols], 2, function(x) as.numeric(as.character(gsub(",", "", x))))
df <- df[df$Age != 'Total', ]
df$Male <- -1 * df$Male
df$Age <- factor(df$Age, levels = df$Age, labels = df$Age)
df.melt <- melt(df,
value.name='Population',
variable.name = 'Gender',
id.vars='Age' )
return(df.melt)
}
nigeria <- get_data("NI", 2014)
install.packages("XML2R")
library(XML)
install.packages("XML")
install.packages("XML")
library(XML)
nigeria <- get_data("NI", 2014)
n1 <- ggplot(nigeria, aes(x = Age, y = Population, fill = Gender)) +
geom_bar(subset = .(Gender == "Female"), stat = "identity") +
geom_bar(subset = .(Gender == "Male"), stat = "identity") +
scale_y_continuous(breaks = seq(-15000000, 15000000, 5000000),
labels = paste0(as.character(c(seq(15, 0, -5), seq(5, 15, 5))), "m")) +
coord_flip() +
scale_fill_brewer(palette = "Set1") +
theme_bw()
get_data <- function(country, year) {
c1 <- "http://www.census.gov/population/international/data/idb/region.php?N=%20Results%20&T=10&A=separate&RT=0&Y="
c2 <- "&R=-1&C="
url <- paste0(c1, year, c2, country)
df <- data.frame(readHTMLTable(url))
keep <- c(2, 4, 5)
df <- df[,keep]
names(df) <- c("Age", "Male", "Female")
cols <- 2:3
df[,cols] <- apply(df[,cols], 2, function(x) as.numeric(as.character(gsub(",", "", x))))
df <- df[df$Age != 'Total', ]
df$Male <- -1 * df$Male
df$Age <- factor(df$Age, levels = df$Age, labels = df$Age)
df.melt <- melt(df,
value.name='Population',
variable.name = 'Gender',
id.vars='Age' )
return(df.melt)
}
nigeria <- get_data("NI", 2014)
nigeria <- get_data("GM", 2014)
# ¿Tiene computadora de escritorio, computadora portátil o tablet en su casa?
a = round(prop.table(table(i_new_data_f$P6, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a)
colnames(a) = c("P6", "Cluster", "Freq")
a
ggplot(a, aes(x = Cluster, y = Freq , fill = P6, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
#Ultima Conexión
table(i_new_data_f$P3)
# Análisis de última conexion
round(prop.table(table(i_new_data_f$P3, i_new_data_f$cluster), margin =2),2)
ggplot(i_new_data_f, aes(x=i_new_data_f$P3, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
# Análisis de última conexion
round(prop.table(table(i_new_data_f$P3, i_new_data_f$cluster), margin =2),2)
# Análisis de última conexion
a = round(prop.table(table(i_new_data_f$P3, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a)
colnames(a) = c("P3", "Cluster", "Freq")
a
ggplot(a, aes(x = Cluster, y = Freq , fill = P3, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
table(i_new_data_f$P7)
table(i_new_data_f$P10)
#### Días que utliza la PC, portatil o tablet en casa
i_new_data_f$P10 <- as.factor(i_new_data_f$P10)
levels(i_new_data_f$P10) <- c(1,2,3,4,5,6,7,"- De 1 Sem", "No Usa")
table(i_new_data_f$P10)
levels(i_new_data_f$P10) <- c(1,2,3,4,5,6,7,"<(1/sem)", "No Usa")
table(i_new_data_f$P10)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
levels(i_new_data_f$P10) <- c(1,2,3,4,5,6,7,"< 1/s ", "No Usa")
table(i_new_data_f$P10)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster))
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster, position_fill(vjust=1)))
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster))
,position=position_dodge()
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
colSums(is.na(i_new_data_f$P10))
Sums(is.na(i_new_data_f$P10))
sum(is.na(i_new_data_f$P10))
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_point(aes(y=..prop.., group = cluster),position="jitter")
bar
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position=position_dodge())
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position="fill")
#### Días que utliza la PC, portatil o tablet en casa
a = round(prop.table(table(i_new_data_f$P10, i_new_data_f$cluster), margin =2),2)
a <- as.data.frame(a)
colnames(a) = c("P10", "Cluster", "Freq")
a
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5))
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_classic()
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal()
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=3, position = position_stack(vjust = 0.5)) + theme_minimal()
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position="fill") + scale_fill_manual(
values= c("skyblue", "royalblue", "blue", "navy"),
limits= c("d", "e", "p", "r"),
breaks=c("d", "e", "p", "r"),
name= "fuel",
labels= c("D", "E", "P", "R")
)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position="fill") + scale_fill_manual(
values= c("skyblue", "royalblue", "blue", "navy")
)
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal()
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal() + scale_fill_brewer(
palette = "Blues"
)
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal() + scale_fill_brewer(
palette = "Reds"
)
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal() +scale_fill_gradientn(
colo
u
rs = terrain.colors(6)
)
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal() +scale_fill_gradientn(
colours = terrain.colors(6)
)
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal() + scale_fill_brewer(
palette = "Reds"
)
ggplot(a, aes(x = Cluster, y = Freq , fill = P10, label= Freq )) +
geom_bar (stat = "identity") + #ggtitle("¿Tienen Computadoras?") +
ylab("%")  + geom_text(size=5, position = position_stack(vjust = 0.5)) + theme_minimal() + scale_fill_brewer(
palette = "Greens"
)
library(RcolorBrewer)
display.brewer.all()
install.packages("RColorBrewer")
library(RcolorBrewer)
display.brewer.all()
library(RcolorBrewer)
library(RcolorBrewer)
install.packages("RColorBrewer")
library(RcolorBrewer)
library(RcolorBrewer)
display.brewer.all()
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position="fill") + scale_fill_brewer(palette = "RdYlGn")
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position="fill") + scale_fill_brewer(palette = "RdYlGn")
library(ggplot2)
ggplot(i_new_data_f, aes(x=P10, fill=cluster)) +
geom_bar(aes(y=..prop.., group = cluster),position="fill") + scale_fill_brewer(palette = "RdYlGn")
